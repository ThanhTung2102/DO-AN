<!DOCTYPE html>
<html>
    <head>
        <title>Javascript</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script language="javascript">
            
        </script>
    </head>
    <body>
        <form action="" onsubmit="return goi()">
            Userdaname: <input type="text" name="username" id="username" value=""/> <br/> <br>
            Password: <input type="password" name="password" id="password" value=""/> <br/><br/>
            <input id="dangnhap" type="submit" name="login" value="Login"/>
        </form>
        <script>

            function validateForm()
{
    var username = document.getElementById('username').value;
    var password = document.getElementById('password').value;
    var a = username.indexOf("@");
    var cham = username.indexOf(".");
    var kt = isNaN(username);
    if(kt==true){
        if (username == ''){
        alert('Bạn chưa nhập tên đăng nhập');
        }
        else if (password == '')
        {
            alert('Bạn chưa nhập mật khẩu');
        }
        else if(cham<1 ||  a<1 ){
            alert("Tên đăng nhập không hợp lệ")
        }
        else if (username[0]=='.' || username[0]=='@'){
                alert('mail không hợp lệ')
            }
        for(let i =1; i<username.length;i++){
            if(username[i]=='@'&& username[i+1]=='@'){
                alert('2 a cong')
            }
            else if(username[i]=='.'&&username[i+1]=='.'){
                alert('2 cham')
            }
            else if(username[username.length-1]=='.' || username[username.    length-1]=='@'){
                alert('cuối dòng')
            }
        } 
    }
    else{
        for(let i =1; i< username.length;i++){
            if(username[0]!=0){
                alert('không hợp lệ')
                break;
            }
        }
    }
}
        function login(){
            let u = document.getElementById("username").value;
            let w = document.getElementById("password").value;
            fetch("../Jason/Account.json")
            .then(function(response){
                if(!response.ok){
                    throw new Error("HTTP error, status:" + response.status)
                }
                return response.json();
            })
            .then(function (check){
                for(p of check.account){
                    if(p.UserName==u && p.Password==w )
                    {
                        alert("thành công")
                        location.replace("LOADID.html?userID="+p.userID)
                        return ;
                    }
                }
                alert("thất bại")
            })
            .catch(function(error){
                alert(error)
            })
        }
        function goi(){
            validateForm();
            login();
        }
        </script>
    </body>
</html>